{% extends 'base.html' %}
{% block content %}

<h2 class="text-2xl font-bold mb-4">🔔 Notificaciones</h2>

<!-- 📌 No leídas -->
<h3 class="text-lg font-semibold mb-2">No leídas</h3>
<ul class="space-y-4 mb-8">
    {% for n in notifications if not n.is_read %}
        {% set icon = "🔔" %}
        {% set bg = "bg-gray-100 border-gray-300 text-gray-700" %}
        {% if "registró" in n.message %}
            {% set icon = "⏱️" %}
            {% set bg = "bg-yellow-50 border-yellow-400 text-yellow-800" %}
        {% elif "actualizó el progreso" in n.message %}
            {% set icon = "📈" %}
            {% set bg = "bg-blue-50 border-blue-400 text-blue-800" %}
        {% elif "cambió de estado" in n.message %}
            {% set icon = "🔄" %}
            {% set bg = "bg-green-50 border-green-400 text-green-800" %}
        {% endif %}

        <li class="p-4 rounded border-l-4 {{ bg }}">
            <div class="flex justify-between items-start gap-4">
                <div class="flex gap-2">
                    <span class="text-lg">{{ icon }}</span>
                    <div>
                        <p class="text-sm font-medium">{{ n.message }}</p>
                        <p class="text-xs text-gray-500">{{ n.timestamp.strftime('%d/%m/%Y %H:%M') }}</p>
                    </div>
                </div>
                <form method="POST" action="{{ url_for('marcar_notificacion_leida', id=n.id) }}">
                    <button class="text-xs bg-corporativo-morado hover:bg-corporativo-naranjo text-white px-2 py-1 rounded">
                        Marcar como leída
                    </button>
                </form>
            </div>
        </li>
    {% else %}
        <p class="text-gray-600">No tienes notificaciones nuevas.</p>
    {% endfor %}
</ul>

<!-- ✅ Leídas -->
<h3 class="text-lg font-semibold mb-2">Leídas</h3>
<ul class="space-y-4">
    {% for n in notifications if n.is_read %}
    <li class="p-3 border border-gray-200 rounded bg-gray-50">
        <div class="flex gap-2">
            <span class="text-lg text-gray-400">📎</span>
            <div>
                <p class="text-sm text-gray-700">{{ n.message }}</p>
                <p class="text-xs text-gray-400">{{ n.timestamp.strftime('%d/%m/%Y %H:%M') }}</p>
            </div>
        </div>
    </li>
    {% else %}
        <p class="text-gray-500">Sin notificaciones leídas.</p>
    {% endfor %}
</ul>

{% endblock %}
